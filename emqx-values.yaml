replicaCount: 3

service:
  type: NodePort
  ports:
    mqtt: 1883
    mqtts: 8883
    dashboard: 18083
    ws: 8083
    wss: 8084
  # Let Kubernetes automatically assign free NodePorts
  # nodePorts:
  #   mqtt: 30083
  #   dashboard: 30080

persistence:
  enabled: true
  size: 5Gi
  storageClass: standard
  mountPath: /opt/emqx/data  # Mount path for Mnesia and other persistent data

dashboard:
  defaultUsername: admin
  defaultPassword: StrongPass123

cluster:
  k8sAutoDiscovery: true        # Auto-discover nodes in the same namespace
  mnesia:
    enabled: true               # Persist Mnesia database for HA sessions & state
    dir: /opt/emqx/data/mnesia # Store Mnesia DB on persistent volume

extraConfig:
  emqx:
    mqtt:
      allow_anonymous: true
      persistent_client_expiration: 24h  # Keep sessions 24h after disconnect
      session_qos_1_retry: 60            # Retry messages if disconnected
      max_clientid_len: 64               # Optional, adjust if needed
